
# 蒙皮

Cocos3D 使用 GPU 蒙皮。

## 蒙皮算法

提供了对两种蒙皮算法的支持：

1. 线性混合蒙皮 骨骼矩阵以 3x4 、列优先的形式存储。
2. 双四元数蒙皮 骨骼矩阵以 双四元数和缩放向量的形式存储。

Cocos3D 内置的标准的蒙皮着色器库 cc-skinning.inc 使用双四元数蒙皮。

## 存储

根据运行时环境，骨骼矩阵可能按以下方式之一存储：

| 存储方式（按优先级） | 存储方式 | 骨骼数限制 |
| --- | --- | --- |
| Uniform | Uniform Float 数组 | 30 |
| RGBA32 浮点纹理 | 每个元素作为 32 位浮点数依次写入到每个通道中 | 无 |
| RGBA8 纹理 | 每个元素作为 32 位浮点数按 `cc.sys.endian` 字节序依次存储在每个像素中 | 无 |
|  |  |  |


下面列出了不同运行时环境中上述存储方式的有效性：

| 运行时环境 | Uniform | RGBA8 纹理 | RGBA32 浮点纹理 |
| --- | --- | --- | --- |
| WebGL 1.0 | √ | √ | 条件支持：需要扩展 OES_texture_float |
| WebGL 2.0 | √ | √ | √ |
|  |  |  |  |